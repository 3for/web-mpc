<html>
<head>
	<title>Trusted Party Secure Session Creator</title>

	<script type="text/javascript" src="../shared/jquery-3.1.1.min.js"></script>
  <script type="text/javascript" src="../shared/underscore.js"></script>
	<script type="text/javascript" src="script/filesaver.js"></script>
	<script type="text/javascript" src="script/generateSession.js"></script>
  <link rel="stylesheet" type="text/css" href="style/bootstrap/css/bootstrap.css">
  <style>
    #infoDiv {
      visibility: hidden;
    }
    input:invalid {
      border: 1px solid red;
    }

    input:valid {
      border: 1px solid green;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="page-header">
      <table width="100%">
        <tr>
          <td>
            <h1>Trusted Party<br/><small>Secure Session Creator</small></h1>
          </td>
          <td align="right">
            <img src="../shared/bu.png" width="110px"/>
          </td>
        </tr>
      </table>
    </div>
    <div>
      <h2>Instructions</h2>
      <p>
        After generating a secure session, please keep the private key file named <b>Session_#######_private_key.pem</b>.
        All secured data will be lost if the private key is lost. Also, do <b>not</b> share your private key. After clicking the 
        "Generate Session" button, email the <b>Session Key</b> to all participants. Once the data is collected from the 
        participants, with your private key, continue to the next step.
      </p>
    </div>
    <br/>
    <div>
      <h3>Initiator Email Address</h3>
      <input autocomplete="off" type=text id="emailID" pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$" required/>
      <h3>Confirmation Token</h3>
      <input autocomplete="off" type=text id="nonceID" pattern="^[a-z0-9]{32}$" required/>
      <h3>Analysts to Invite</h3>
      <input autocomplete="off" type=text id="analystsID" pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}(,[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})*$" required/>
    </div>
    <button class="btn btn-primary btn-lg" id="Generate" 
            onclick="generateSession('emailID','nonceID','analystsID','infoDiv','sessionID','pubkeyID','privkeyID','linkID')">
      Generate Session
    </button>
      <div id="infoDiv">
        <h3><a id="linkID" href="session_data.html"></a></h3>
        <br/>
        <h3>Session Key (please email to participants)</h3>
        <pre id="sessionID"></pre>
        <br/>
        <h3>Public Key</h3>
        <pre id="pubkeyID"></pre>
        <br/>
        <h3>Private Key (do not share)</h3>
        <pre id="privkeyID"></pre>
      </div>
    </div>
</body>
</html>